<?xml version="1.0" encoding="UTF-8"?>
<idea-plugin>
    <id>com.codecrucible.multi-voice-ai</id>
    <name>CodeCrucible: Multi-Voice AI Assistant</name>
    <version>1.0.0</version>
    <vendor email="support@codecrucible.com" url="https://codecrucible.com">CodeCrucible</vendor>

    <description><![CDATA[
        Consciousness-driven AI development with multi-voice council generation, synthesis, and collaboration.
        
        Features:
        • Multi-voice AI code generation with specialized perspectives
        • Real-time solution synthesis and optimization
        • Intelligent voice recommendations
        • Team collaboration and shared profiles
        • Decision history and consciousness tracking
        • Seamless integration with JetBrains IDEs
        
        Transform your development workflow with AI council collaboration that goes beyond single-voice assistants.
    ]]></description>

    <change-notes><![CDATA[
        <h3>Version 1.0.0</h3>
        <ul>
            <li>Initial release with multi-voice AI generation</li>
            <li>Tool window integration for council panel</li>
            <li>Editor actions for code generation and review</li>
            <li>Live template support for common patterns</li>
            <li>Inspection integration for quality assessment</li>
        </ul>
    ]]></change-notes>

    <!-- Please see https://plugins.jetbrains.com/docs/intellij/build-number-ranges.html for description -->
    <idea-version since-build="231.0"/>

    <!-- Please see https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html -->
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.lang</depends>
    <depends>com.intellij.modules.java</depends>

    <resource-bundle>messages.CodeCrucibleBundle</resource-bundle>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Tool Window -->
        <toolWindow id="CodeCrucible" 
                   anchor="right" 
                   factoryClass="com.codecrucible.toolwindow.CouncilToolWindowFactory"
                   icon="/icons/codecrucible_13.svg"/>

        <!-- Actions -->
        <action id="codecrucible.generateWithCouncil"
                class="com.codecrucible.actions.GenerateWithCouncilAction"
                text="Generate with AI Council"
                description="Generate code using multi-voice AI council"
                icon="/icons/brain_16.svg">
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
            <add-to-group group-id="ProjectViewPopupMenu" anchor="first"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift C"/>
        </action>

        <action id="codecrucible.synthesizeSolutions"
                class="com.codecrucible.actions.SynthesizeSolutionsAction"
                text="Synthesize Solutions"
                description="Combine multiple AI solutions into optimized result"
                icon="/icons/combine_16.svg">
            <add-to-group group-id="EditorPopupMenu" anchor="after" relative-to-action="codecrucible.generateWithCouncil"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift S"/>
        </action>

        <action id="codecrucible.reviewCurrentFile"
                class="com.codecrucible.actions.ReviewCurrentFileAction"
                text="Review with AI Council"
                description="Review current file for quality and best practices"
                icon="/icons/eye_16.svg">
            <add-to-group group-id="EditorPopupMenu" anchor="after" relative-to-action="codecrucible.synthesizeSolutions"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift R"/>
        </action>

        <action id="codecrucible.openSettings"
                class="com.codecrucible.actions.OpenSettingsAction"
                text="CodeCrucible Settings"
                description="Configure CodeCrucible plugin settings"
                icon="/icons/settings_16.svg">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </action>

        <!-- Live Templates -->
        <liveTemplateContext implementation="com.codecrucible.templates.CodeCrucibleTemplateContextType"/>
        
        <!-- Inspections -->
        <localInspection language="JAVA"
                        shortName="CodeCrucibleQualityInspection"
                        displayName="CodeCrucible Quality Assessment"
                        groupName="CodeCrucible"
                        enabledByDefault="true"
                        level="WEAK WARNING"
                        implementationClass="com.codecrucible.inspections.QualityAssessmentInspection"/>

        <localInspection language="JavaScript"
                        shortName="CodeCrucibleJSQualityInspection"
                        displayName="CodeCrucible JS/TS Quality Assessment"
                        groupName="CodeCrucible"
                        enabledByDefault="true"
                        level="WEAK WARNING"
                        implementationClass="com.codecrucible.inspections.JSQualityAssessmentInspection"/>

        <!-- Application Service -->
        <applicationService serviceImplementation="com.codecrucible.services.CodeCrucibleApplicationService"/>
        
        <!-- Project Service -->
        <projectService serviceImplementation="com.codecrucible.services.CodeCrucibleProjectService"/>

        <!-- Settings -->
        <applicationConfigurable parentId="tools"
                               instance="com.codecrucible.settings.CodeCrucibleConfigurable"
                               id="codecrucible.settings"
                               displayName="CodeCrucible"/>

        <!-- Notification Groups -->
        <notificationGroup id="CodeCrucible" displayType="BALLOON" key="notification.group.codecrucible"/>

        <!-- File Types -->
        <fileType name="CodeCrucible Session"
                 implementationClass="com.codecrucible.filetypes.SessionFileType"
                 fieldName="INSTANCE"
                 language="JSON"
                 extensions="ccses"/>

        <!-- Language Extensions -->
        <completion.contributor language="JAVA"
                              implementationClass="com.codecrucible.completion.CouncilCompletionContributor"/>
        
        <completion.contributor language="JavaScript"
                              implementationClass="com.codecrucible.completion.JSCouncilCompletionContributor"/>

        <!-- Intention Actions -->
        <intentionAction>
            <className>com.codecrucible.intentions.GenerateWithCouncilIntention</className>
            <category>CodeCrucible</category>
        </intentionAction>

        <intentionAction>
            <className>com.codecrucible.intentions.RefactorWithCouncilIntention</className>
            <category>CodeCrucible</category>
        </intentionAction>

        <!-- Gutter Icon Provider -->
        <codeInsight.lineMarkerProvider language="JAVA"
                                      implementationClass="com.codecrucible.lineMarkers.CouncilLineMarkerProvider"/>

        <!-- Document Events -->
        <editorFactoryListener implementation="com.codecrucible.listeners.EditorFactoryListener"/>
    </extensions>

    <applicationListeners>
        <listener class="com.codecrucible.listeners.ApplicationActivationListener"
                 topic="com.intellij.openapi.application.ApplicationActivationListener"/>
    </applicationListeners>

    <projectListeners>
        <listener class="com.codecrucible.listeners.ProjectOpenCloseListener"
                 topic="com.intellij.openapi.project.ProjectManagerListener"/>
    </projectListeners>

    <actions>
        <!-- Main Menu -->
        <group id="codecrucible.mainMenu" text="CodeCrucible" description="CodeCrucible AI Council">
            <action id="codecrucible.authenticate"
                    class="com.codecrucible.actions.AuthenticateAction"
                    text="Authenticate"
                    description="Authenticate with CodeCrucible service"/>
            
            <separator/>
            
            <action id="codecrucible.showDecisionHistory"
                    class="com.codecrucible.actions.ShowDecisionHistoryAction"
                    text="Decision History"
                    description="View AI council decision history"/>
            
            <action id="codecrucible.openDashboard"
                    class="com.codecrucible.actions.OpenDashboardAction"
                    text="Open Dashboard"
                    description="Open CodeCrucible web dashboard"/>
            
            <separator/>
            
            <reference ref="codecrucible.openSettings"/>
            
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </group>

        <!-- Editor Context Menu -->
        <group id="codecrucible.editorContextMenu" text="CodeCrucible" popup="true">
            <reference ref="codecrucible.generateWithCouncil"/>
            <reference ref="codecrucible.reviewCurrentFile"/>
            <reference ref="codecrucible.synthesizeSolutions"/>
            
            <separator/>
            
            <action id="codecrucible.explainCode"
                    class="com.codecrucible.actions.ExplainCodeAction"
                    text="Explain Selected Code"
                    description="Get AI council explanation of selected code"/>
            
            <action id="codecrucible.optimizeCode"
                    class="com.codecrucible.actions.OptimizeCodeAction"
                    text="Optimize with Council"
                    description="Optimize selected code using AI council"/>
            
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
        </group>

        <!-- Project View Context Menu -->
        <group id="codecrucible.projectViewContextMenu" text="CodeCrucible">
            <action id="codecrucible.analyzeFile"
                    class="com.codecrucible.actions.AnalyzeFileAction"
                    text="Analyze with AI Council"
                    description="Analyze file using multi-voice AI council"/>
            
            <action id="codecrucible.generateTests"
                    class="com.codecrucible.actions.GenerateTestsAction"
                    text="Generate Tests"
                    description="Generate unit tests using AI council"/>
            
            <add-to-group group-id="ProjectViewPopupMenu" anchor="last"/>
        </group>
    </actions>

    <!-- Keymap -->
    <actions>
        <action id="codecrucible.quickGenerate"
                class="com.codecrucible.actions.QuickGenerateAction"
                text="Quick AI Generation"
                description="Quick AI code generation with default voices">
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt G"/>
        </action>
        
        <action id="codecrucible.toggleToolWindow"
                class="com.codecrucible.actions.ToggleToolWindowAction"
                text="Toggle CodeCrucible Panel"
                description="Show/hide CodeCrucible tool window">
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt C"/>
        </action>
    </actions>
</idea-plugin>